(function(v,e,u,t,b,d,S,R,h,m){"use strict";const{View:E,Text:A,Pressable:P,ScrollView:C}=S.General,{FormRow:c,FormSwitch:_,FormRadio:o,FormDivider:g}=S.Forms,N=u.findByStoreName("UserStore");let w;e.storage.avatarSize??="medium",e.storage.animation??="pulse",e.storage.maxAvatars??=5,e.storage.borderStyle??="round",e.storage.showNames??=!1;const p={small:12,medium:16,large:24};function I({channel:a}){m.useProxy(e.storage);const f=u.findByProps("TYPING_WRAPPER_HEIGHT"),l=u.findByProps("AvatarSizes")?.default;if(!f?.useTypingUserIds||!l)return null;const s=f.useTypingUserIds(a.id)?.map(function(i){return N?.getUser(i)}).filter(Boolean)||[];if(s.length===0)return null;const n=p[e.storage.avatarSize]||16,y=e.storage.borderStyle==="round"?n/2:4,r=t.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",alignItems:"center",height:n+4},avatarWrapper:{borderWidth:2,borderRadius:y,borderColor:d.semanticColors.BACKGROUND_SECONDARY,backgroundColor:d.semanticColors.BACKGROUND_SECONDARY,marginLeft:-6},overflow:{width:n,height:n,borderRadius:y,backgroundColor:d.semanticColors.BACKGROUND_TERTIARY,justifyContent:"center",alignItems:"center"},overflowText:{fontSize:n*.4,color:d.semanticColors.TEXT_NORMAL,fontWeight:"bold"},nameText:{fontSize:12,color:d.semanticColors.TEXT_MUTED,marginLeft:8}}),D=s.slice(0,e.storage.maxAvatars),T=s.length-e.storage.maxAvatars,U=function(){const i=s.map(function(x){return x.username}).join(", ");h.showToast(`Typing: ${i}`,R.getAssetIDByName("ic_message_edit"))};return t.React.createElement(P,{onPress:U},t.React.createElement(E,{style:r.container},D.map(function(i,x){return t.React.createElement(E,{key:i.id,style:r.avatarWrapper},t.React.createElement(l,{user:i,size:n===12?"SIZE_12":n===16?"SIZE_16":"SIZE_24",guildId:a.guild_id}))}),T>0&&t.React.createElement(E,{style:[r.avatarWrapper,r.overflow]},t.React.createElement(A,{style:r.overflowText},`+${T}`)),e.storage.showNames&&s.length===1&&t.React.createElement(A,{style:r.nameText},s[0].username)))}function z(){return m.useProxy(e.storage),t.React.createElement(C,{},t.React.createElement(c,{label:"Avatar Size",subLabel:"Choose the size of typing avatars",trailing:t.React.createElement(c.Arrow)}),t.React.createElement(o,{label:"Small (12px)",selected:e.storage.avatarSize==="small",onPress:function(){return e.storage.avatarSize="small"}}),t.React.createElement(o,{label:"Medium (16px)",selected:e.storage.avatarSize==="medium",onPress:function(){return e.storage.avatarSize="medium"}}),t.React.createElement(o,{label:"Large (24px)",selected:e.storage.avatarSize==="large",onPress:function(){return e.storage.avatarSize="large"}}),t.React.createElement(g),t.React.createElement(c,{label:"Border Style",subLabel:"Choose avatar border shape",trailing:t.React.createElement(c.Arrow)}),t.React.createElement(o,{label:"Round",selected:e.storage.borderStyle==="round",onPress:function(){return e.storage.borderStyle="round"}}),t.React.createElement(o,{label:"Square",selected:e.storage.borderStyle==="square",onPress:function(){return e.storage.borderStyle="square"}}),t.React.createElement(g),t.React.createElement(c,{label:"Max Avatars",subLabel:`Show up to ${e.storage.maxAvatars} avatars before showing +X`,trailing:t.React.createElement(c.Arrow)}),t.React.createElement(o,{label:"3 avatars",selected:e.storage.maxAvatars===3,onPress:function(){return e.storage.maxAvatars=3}}),t.React.createElement(o,{label:"5 avatars",selected:e.storage.maxAvatars===5,onPress:function(){return e.storage.maxAvatars=5}}),t.React.createElement(o,{label:"10 avatars",selected:e.storage.maxAvatars===10,onPress:function(){return e.storage.maxAvatars=10}}),t.React.createElement(g),t.React.createElement(_,{label:"Show Username",subLabel:"Show username when only one person is typing",value:e.storage.showNames,onValueChange:function(a){return e.storage.showNames=a}}))}var B={onLoad:function(){try{const a=u.findByProps("TYPING_WRAPPER_HEIGHT");if(!a)throw new Error("Could not find TypingWrapper");w=b.after("default",a,function([{channel:f}],l){if(!l?.props?.children)return l;const s=l.props.children;if(!s?.type)return l;const n=b.after("type",s,function(y,r){return t.React.useEffect(function(){return function(){return n()}},[]),r?.props?.children?.[0]?.props?.children&&r.props.children[0].props.children.splice(0,1,t.React.createElement(I,{channel:f})),r});return l}),h.showToast("Typing Avatars loaded!",R.getAssetIDByName("Check"))}catch(a){h.showToast("Typing Avatars failed: "+a.message,R.getAssetIDByName("Small")),console.error("Typing Avatars error:",a)}},onUnload:function(){w?.()},settings:z};return v.default=B,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts,vendetta.storage);
